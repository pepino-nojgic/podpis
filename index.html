<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vytvo≈ô si sv≈Øj podpis | Media:list</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Arial', 'Helvetica', sans-serif;
        }
        #loginScreen {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #0B64D8 0%, #094ba8 100%);
        }
        #mainApp {
            display: none;
        }
        .logo-pulse {
            animation: pulse 2s ease-in-out infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
    </style>
</head>
<body>
    <!-- P≈ôihla≈°ovac√≠ obrazovka -->
    <div id="loginScreen">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md">
            <div class="text-center mb-8">
                <div class="mb-6">
                    <img src="https://cdn.medialist.cz/ml_logo.png" alt="Media:list" class="h-12 mx-auto logo-pulse">
                </div>
                <h1 class="text-3xl font-bold text-gray-800 mb-2">üîê Ahoj!</h1>
                <p class="text-gray-600">Pro p≈ô√≠stup zadej heslo</p>
            </div>
            
            <form onsubmit="checkPassword(event)" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">P≈ô√≠stupov√© heslo</label>
                    <input 
                        type="password" 
                        id="passwordInput"
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                        autofocus
                    >
                </div>
                
                <div id="errorMessage" class="hidden">
                    <div class="bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg text-sm">
                        ‚ùå Nespr√°vn√© heslo, zkus to znovu
                    </div>
                </div>
                
                <button 
                    type="submit"
                    class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition-colors"
                >
                    Vstoupit
                </button>
            </form>
            
            <div class="mt-6 text-center text-sm text-gray-500">
                Nev√≠≈° heslo? Zeptej se v IT üòä
            </div>
        </div>
    </div>

    <!-- Hlavn√≠ aplikace -->
    <div id="mainApp" class="bg-gradient-to-br from-blue-50 to-gray-100 min-h-screen">
        <!-- Header s logem -->
        <div class="bg-white shadow-sm border-b border-gray-200">
            <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
                <div class="flex items-center gap-4">
                    <img src="https://cdn.medialist.cz/ml_logo.png" alt="Media:list" class="h-8">
                    <div class="border-l border-gray-300 pl-4">
                        <h1 class="text-xl font-bold text-gray-800">Gener√°tor podpis≈Ø</h1>
                        <p class="text-sm text-gray-500">Vytvo≈ô si sv≈Øj profesion√°ln√≠ podpis</p>
                    </div>
                </div>
                <button onclick="logout()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-colors">
                    üö™ Odhl√°sit se
                </button>
            </div>
        </div>

        <div class="max-w-7xl mx-auto p-6">
            <div class="grid lg:grid-cols-5 gap-6">
                <!-- Formul√°≈ô - u≈æ≈°√≠ -->
                <div class="lg:col-span-2 bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">‚úèÔ∏è Tvoje √∫daje</h2>
                    <p class="text-sm text-gray-500 mb-6">Vypl≈à informace, kter√© se maj√≠ objevit v podpisu</p>
                    
                    <div class="space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Jm√©no</label>
                                <input type="text" id="firstName" value="Tom√°≈°" 
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">P≈ô√≠jmen√≠</label>
                                <input type="text" id="lastName" value="Kaƒçena"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Pozice</label>
                            <input type="text" id="position" value="CEO"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                placeholder="nap≈ô. Marketing Manager">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Telefon</label>
                            <input type="text" id="phone" value="777 668 928"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                placeholder="777 123 456"
                                maxlength="11">
                            <p class="text-xs text-gray-500 mt-1">üí° Pi≈° jen ƒç√≠slo, p≈ôedvolba +420 se p≈ôid√° automaticky</p>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">E-mail</label>
                            <input type="email" id="email" value="tomas.kacena@media-list.cz"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                placeholder="jmeno.prijmeni@media-list.cz">
                            <p class="text-xs text-gray-500 mt-1">üí° Vypln√≠ se automaticky podle jm√©na</p>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">LinkedIn profil</label>
                            <input type="text" id="linkedin" value="tomaskacena"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                placeholder="tvoje-jmeno">
                            <div class="flex items-center gap-2 mt-2">
                                <input type="checkbox" id="showLinkedIn" checked class="w-4 h-4 text-blue-600 rounded">
                                <label for="showLinkedIn" class="text-xs text-gray-600">Zobrazit LinkedIn v podpisu</label>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">üì∏ N√°zev tv√© fotky</label>
                            <input type="text" id="photoFilename" value="Kacena"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                placeholder="Prijmeni">
                            <p class="text-xs text-gray-500 mt-1">üí° Vypln√≠ se automaticky z p≈ô√≠jmen√≠ (bez h√°ƒçk≈Ø)</p>
                        </div>

                        <div class="flex items-center gap-3 pt-4 border-t">
                            <input type="checkbox" id="darkMode" class="w-5 h-5 text-blue-600 rounded">
                            <label for="darkMode" class="text-sm font-medium text-gray-700">üåô Tmav√° varianta</label>
                        </div>
                    </div>

                    <div class="mt-6 flex gap-3">
                        <button onclick="copyToClipboard()" 
                            class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors">
                            <span id="copyBtn">üìã Kop√≠rovat</span>
                        </button>
                        <button onclick="downloadHTML()"
                            class="flex-1 bg-gray-700 hover:bg-gray-800 text-white font-semibold py-3 px-6 rounded-lg transition-colors">
                            üíæ St√°hnout
                        </button>
                    </div>

                    <div class="mt-6 pt-6 border-t">
                        <h3 class="font-semibold text-gray-800 mb-3">üì¶ Hromadn√© vytvo≈ôen√≠</h3>
                        <p class="text-sm text-gray-600 mb-3">M√°≈° v√≠c lid√≠? Nahraj CSV soubor se v≈°emi √∫daji</p>
                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-500 transition-colors">
                            <input type="file" id="csvFile" accept=".csv" onchange="handleCSV(event)" class="hidden">
                            <label for="csvFile" class="cursor-pointer">
                                <div class="text-4xl mb-2">üì§</div>
                                <span class="text-sm text-gray-600">Klikni nebo p≈ôet√°hni CSV soubor</span>
                            </label>
                        </div>
                        <p class="text-xs text-gray-500 mt-2">Form√°t: Jm√©no,P≈ô√≠jmen√≠,Pozice,Telefon,Email,LinkedIn,Fotka</p>
                        <div id="csvResult" class="mt-4"></div>
                    </div>
                </div>

                <!-- N√°hled - ≈°ir≈°√≠ -->
                <div class="lg:col-span-3 bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">üëÅÔ∏è N√°hled</h2>
                    <p class="text-sm text-gray-500 mb-6">Takhle bude tv≈Øj podpis vypadat</p>
                    <div id="preview" class="border-2 rounded-lg p-8 bg-gray-50 border-gray-200 overflow-auto"></div>
                    
                    <div class="mt-6 p-4 bg-blue-50 rounded-lg border-l-4 border-blue-500">
                        <h3 class="font-semibold text-blue-900 mb-3">üí° Jak na to?</h3>
                        <div class="space-y-2 text-sm text-blue-800">
                            <p><strong>1.</strong> Vypl≈à sv√© √∫daje v√Ω≈°e</p>
                            <p><strong>2.</strong> Klikni na "Kop√≠rovat"</p>
                            <p><strong>3.</strong> V Gmailu: Nastaven√≠ ‚Üí Podpis ‚Üí vlo≈æ (Ctrl+V)</p>
                            <p><strong>4.</strong> V Outlooku: Soubor ‚Üí Mo≈ænosti ‚Üí Po≈°ta ‚Üí Podpisy</p>
                        </div>
                    </div>

                    <div class="mt-4 p-4 bg-green-50 rounded-lg">
                        <p class="text-sm text-green-800">
                            <strong>üíö Tip:</strong> Podpis se automaticky aktualizuje, kdy≈æ zmƒõn√≠≈° √∫daje. Vyzkou≈°ej si r≈Øzn√© varianty!
                        </p>
                    </div>
                </div>
            </div>

            <!-- Info panel -->
            <div class="mt-6 bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">üìö Co je dobr√© vƒõdƒõt</h3>
                <div class="grid md:grid-cols-4 gap-4 text-sm">
                    <div class="p-4 bg-blue-50 rounded-lg border-l-4 border-blue-500">
                        <div class="font-semibold text-gray-700 mb-2">‚úÖ Funguje v≈°ude</div>
                        <ul class="text-gray-600 space-y-1">
                            <li>‚Ä¢ Gmail (web, mobil)</li>
                            <li>‚Ä¢ Apple Mail (Mac, iPhone)</li>
                            <li>‚Ä¢ Outlook (v≈°ude)</li>
                        </ul>
                    </div>
                    <div class="p-4 bg-purple-50 rounded-lg border-l-4 border-purple-500">
                        <div class="font-semibold text-gray-700 mb-2">üé® Design</div>
                        <ul class="text-gray-600 space-y-1">
                            <li>‚Ä¢ Firemn√≠ barvy Media:list</li>
                            <li>‚Ä¢ Arial font (kompatibiln√≠)</li>
                            <li>‚Ä¢ Tvoje profilov√° fotka</li>
                        </ul>
                    </div>
                    <div class="p-4 bg-green-50 rounded-lg border-l-4 border-green-500">
                        <div class="font-semibold text-gray-700 mb-2">üöÄ CDN</div>
                        <ul class="text-gray-600 space-y-1">
                            <li>‚Ä¢ Rychl√© naƒç√≠t√°n√≠</li>
                            <li>‚Ä¢ Retina kvalita</li>
                            <li>‚Ä¢ Optimalizovan√© obr√°zky</li>
                        </ul>
                    </div>
                    <div class="p-4 bg-orange-50 rounded-lg border-l-4 border-orange-500">
                        <div class="font-semibold text-gray-700 mb-2">‚ö° Auto-funkce</div>
                        <ul class="text-gray-600 space-y-1">
                            <li>‚Ä¢ Email se vypln√≠ s√°m</li>
                            <li>‚Ä¢ Telefon auto-form√°t</li>
                            <li>‚Ä¢ Live preview</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="mt-6 text-center text-sm text-gray-500">
                <p>Vytvo≈ôeno s ‚ù§Ô∏è pro t√Ωm Media:list</p>
                <p class="mt-1">M√°≈° probl√©m? Napi≈° na IT oddƒõlen√≠</p>
            </div>
        </div>
    </div>

    <script>
        // ===========================================
        // HESLO - ZMƒö≈á TOTO!
        // ===========================================
        const CORRECT_PASSWORD = "medialist2025";
        const SESSION_TIMEOUT = 30 * 60 * 1000; // 30 minut
        
        window.addEventListener('load', () => {
            const sessionExpiry = localStorage.getItem('sessionExpiry');
            if (sessionExpiry && Date.now() < parseInt(sessionExpiry)) {
                showApp();
            }
        });

        function checkPassword(event) {
            event.preventDefault();
            const password = document.getElementById('passwordInput').value;
            
            if (password === CORRECT_PASSWORD) {
                const expiry = Date.now() + SESSION_TIMEOUT;
                localStorage.setItem('sessionExpiry', expiry.toString());
                showApp();
            } else {
                document.getElementById('errorMessage').classList.remove('hidden');
                document.getElementById('passwordInput').value = '';
                setTimeout(() => {
                    document.getElementById('errorMessage').classList.add('hidden');
                }, 3000);
            }
        }

        function showApp() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            
            // Automaticky vygeneruj email, fotku a naform√°tuj telefon p≈ôi naƒçten√≠
            generateEmail();
            generatePhotoFilename();
            
            updatePreview();
        }

        function logout() {
            if (confirm('Opravdu se chce≈° odhl√°sit?')) {
                localStorage.removeItem('sessionExpiry');
                document.getElementById('loginScreen').style.display = 'flex';
                document.getElementById('mainApp').style.display = 'none';
                document.getElementById('passwordInput').value = '';
            }
        }

        setInterval(() => {
            const sessionExpiry = localStorage.getItem('sessionExpiry');
            if (!sessionExpiry || Date.now() >= parseInt(sessionExpiry)) {
                logout();
            }
        }, 60000);

        // ===========================================
        // GENER√ÅTOR
        // ===========================================
        
        // Odstranƒõn√≠ diakritiky
        function removeDiacritics(str) {
            const diacriticsMap = {
                '√°': 'a', 'ƒç': 'c', 'ƒè': 'd', '√©': 'e', 'ƒõ': 'e', '√≠': 'i',
                '≈à': 'n', '√≥': 'o', '≈ô': 'r', '≈°': 's', '≈•': 't', '√∫': 'u',
                '≈Ø': 'u', '√Ω': 'y', '≈æ': 'z',
                '√Å': 'A', 'ƒå': 'C', 'ƒé': 'D', '√â': 'E', 'ƒö': 'E', '√ç': 'I',
                '≈á': 'N', '√ì': 'O', '≈ò': 'R', '≈†': 'S', '≈§': 'T', '√ö': 'U',
                '≈Æ': 'U', '√ù': 'Y', '≈Ω': 'Z'
            };
            return str.replace(/[^\u0000-\u007E]/g, char => diacriticsMap[char] || char);
        }

        // Auto-generov√°n√≠ emailu
        function generateEmail() {
            const firstName = document.getElementById('firstName').value.trim();
            const lastName = document.getElementById('lastName').value.trim();
            
            if (firstName && lastName) {
                const firstNameClean = removeDiacritics(firstName).toLowerCase();
                const lastNameClean = removeDiacritics(lastName).toLowerCase();
                const email = `${firstNameClean}.${lastNameClean}@media-list.cz`;
                document.getElementById('email').value = email;
            }
        }

        // Auto-generov√°n√≠ n√°zvu fotky z p≈ô√≠jmen√≠
        function generatePhotoFilename() {
            const lastName = document.getElementById('lastName').value.trim();
            
            if (lastName) {
                // Odstra≈à diakritiku a zachovej prvn√≠ p√≠smeno velk√©
                const cleaned = removeDiacritics(lastName);
                const filename = cleaned.charAt(0).toUpperCase() + cleaned.slice(1).toLowerCase();
                document.getElementById('photoFilename').value = filename;
            }
        }

        // Form√°tov√°n√≠ telefonu - OPRAVENO bez posunu kurzoru
        function formatPhone(value) {
            // Odstra≈à v≈°echno kromƒõ ƒç√≠slic
            let numbers = value.replace(/\D/g, '');
            
            // Odstra≈à 420 pokud tam je (aby se dalo norm√°lnƒõ ps√°t)
            if (numbers.startsWith('420')) {
                numbers = numbers.substring(3);
            }
            
            // O≈ô√≠zni na 9 ƒç√≠slic
            numbers = numbers.substring(0, 9);
            
            // Form√°tuj: +420 XXX XXX XXX
            if (numbers.length === 0) {
                return '';
            }
            
            let formatted = '+420';
            if (numbers.length > 0) {
                formatted += ' ' + numbers.substring(0, 3);
            }
            if (numbers.length > 3) {
                formatted += ' ' + numbers.substring(3, 6);
            }
            if (numbers.length > 6) {
                formatted += ' ' + numbers.substring(6, 9);
            }
            
            return formatted;
        }

        // Event listeners
        document.getElementById('firstName').addEventListener('input', () => {
            generateEmail();
            updatePreview();
        });
        
        document.getElementById('lastName').addEventListener('input', () => {
            generateEmail();
            generatePhotoFilename();
            updatePreview();
        });
        
        // Opraven√© form√°tov√°n√≠ telefonu - form√°tuje a≈æ p≈ôi opu≈°tƒõn√≠ pole
        document.getElementById('phone').addEventListener('blur', (e) => {
            e.target.value = formatPhone(e.target.value);
            updatePreview();
        });
        
        // Ostatn√≠ pole - bƒõ≈æn√Ω update preview
        ['position', 'email', 'linkedin', 'photoFilename', 'darkMode', 'showLinkedIn'].forEach(id => {
            const element = document.getElementById(id);
            if (element) {
                element.addEventListener('input', updatePreview);
                element.addEventListener('change', updatePreview);
            }
        });
        inputs.forEach(id => {
            const element = document.getElementById(id);
            if (element) {
                element.addEventListener('input', updatePreview);
                element.addEventListener('change', updatePreview);
            }
        });

        function generateSignatureHTML() {
            const data = {
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                position: document.getElementById('position').value,
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value,
                linkedin: document.getElementById('linkedin').value,
                photoFilename: document.getElementById('photoFilename').value
            };

            const isDark = document.getElementById('darkMode').checked;
            const showLinkedIn = document.getElementById('showLinkedIn').checked;
            const bgColor = isDark ? '#1a1a1a' : '#ffffff';
            const textColor = isDark ? '#e5e5e5' : '#222222';
            const accentColor = '#0B64D8';

            // Form√°tuj telefon pro zobrazen√≠
            const phoneDisplay = formatPhone(data.phone);
            const phoneHref = data.phone.replace(/\D/g, '');

            // LinkedIn ƒç√°st - zobrazit jen pokud je za≈°krtnuto
            const linkedInHTML = showLinkedIn && data.linkedin ? `
          <td valign="middle" style="padding:2px 8px 2px 0;">
            <img src="https://cdn.medialist.cz/LinkedIN.png" width="22" height="22" alt="LinkedIn" style="display:block;width:22px;height:22px;border:0;outline:0;-ms-interpolation-mode:bicubic;">
          </td>
          <td valign="middle" style="padding:2px 0 2px 0;">
            <a href="https://www.linkedin.com/in/${data.linkedin}/" style="color:${textColor};text-decoration:none;">linkedin.com/in/${data.linkedin}/</a>
          </td>` : '';

            return `<!-- ====== EMAIL SIGNATURE ¬∑ media:list ¬∑ ${data.firstName} ${data.lastName} ====== -->
<table role="presentation" cellpadding="0" cellspacing="0" border="0" style="border-collapse:collapse;background:${bgColor};font-family:Arial,Helvetica,sans-serif;color:${textColor};">
  <tr>
    <td valign="top" style="padding:0 8px 8px 0;">
      <img src="https://cdn.medialist.cz/profil/ML_1080x1080px_${data.photoFilename}.png"
           width="140" height="140" alt="${data.firstName} ${data.lastName}"
           style="display:block;border:0;outline:0;width:140px;height:140px;background:${bgColor};-ms-interpolation-mode:bicubic;">
    </td>
    <td valign="top" style="padding-top:15px;">
      <table role="presentation" cellpadding="0" cellspacing="0" border="0" style="border-collapse:collapse;">
        <tr>
          <td style="font-size:22px;line-height:28px;font-weight:700;color:${textColor};padding:0 10px 6px 0;white-space:nowrap;">${data.firstName} ${data.lastName}</td>
          <td style="font-size:22px;line-height:28px;font-weight:700;color:${accentColor};padding:0 0 6px 0;white-space:nowrap;">${data.position}</td>
        </tr>
      </table>
      <table role="presentation" cellpadding="0" cellspacing="0" border="0" style="border-collapse:collapse;font-size:15px;line-height:21px;color:${textColor};font-weight:400;mso-line-height-rule:exactly;">
        <tr>
          <td valign="middle" style="padding:2px 8px 2px 0;">
            <img src="https://cdn.medialist.cz/Phone.png" width="22" height="22" alt="Telefon" style="display:block;width:22px;height:22px;border:0;outline:0;-ms-interpolation-mode:bicubic;">
          </td>
          <td valign="middle" style="padding:2px 18px 2px 0;white-space:nowrap;">
            <a href="tel:+420${phoneHref}" style="color:${textColor};text-decoration:none;">${phoneDisplay}</a>
          </td>
          <td valign="middle" style="padding:2px 8px 2px 0;">
            <img src="https://cdn.medialist.cz/Mail.png" width="22" height="22" alt="E-mail" style="display:block;width:22px;height:22px;border:0;outline:0;-ms-interpolation-mode:bicubic;">
          </td>
          <td valign="middle" style="padding:2px 0 2px 0;">
            <a href="mailto:${data.email}" style="color:${textColor};text-decoration:none;">${data.email}</a>
          </td>
        </tr>
      </table>
      <table role="presentation" cellpadding="0" cellspacing="0" border="0" width="1" style="border-collapse:collapse;">
        <tr><td style="line-height:0;font-size:0;height:4px;">&nbsp;</td></tr>
      </table>
      <table role="presentation" cellpadding="0" cellspacing="0" border="0" style="border-collapse:collapse;font-size:15px;line-height:21px;color:${textColor};font-weight:400;mso-line-height-rule:exactly;">
        <tr>
          <td valign="middle" style="padding:2px 8px 2px 0;">
            <img src="https://cdn.medialist.cz/web.png" width="22" height="22" alt="Web" style="display:block;width:22px;height:22px;border:0;outline:0;-ms-interpolation-mode:bicubic;">
          </td>
          <td valign="middle" style="padding:2px 18px 2px 0;">
            <a href="https://medialist.cz" style="color:${textColor};text-decoration:none;">medialist.cz</a>
          </td>${linkedInHTML}
        </tr>
      </table>
      <table role="presentation" cellpadding="0" cellspacing="0" border="0" style="border-collapse:collapse;margin-top:6px;">
        <tr>
          <td style="padding:5px 0 0 0;">
            <img src="https://cdn.medialist.cz/ml_logo.png" width="130" alt="media:list logo" style="display:block;border:0;outline:0;width:130px;height:auto;background:${bgColor};-ms-interpolation-mode:bicubic;">
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>`;
        }

        function updatePreview() {
            const html = generateSignatureHTML();
            const isDark = document.getElementById('darkMode').checked;
            const preview = document.getElementById('preview');
            preview.innerHTML = html;
            preview.className = isDark 
                ? 'border-2 rounded-lg p-8 bg-gray-900 border-gray-700 overflow-auto'
                : 'border-2 rounded-lg p-8 bg-gray-50 border-gray-200 overflow-auto';
        }

        async function copyToClipboard() {
            const html = generateSignatureHTML();
            const btn = document.getElementById('copyBtn');
            
            try {
                await navigator.clipboard.write([
                    new ClipboardItem({
                        'text/html': new Blob([html], { type: 'text/html' }),
                        'text/plain': new Blob([html], { type: 'text/plain' })
                    })
                ]);
                btn.textContent = '‚úÖ Zkop√≠rov√°no!';
                setTimeout(() => btn.textContent = 'üìã Kop√≠rovat', 2000);
            } catch (err) {
                const textArea = document.createElement('textarea');
                textArea.value = html;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                btn.textContent = '‚úÖ Zkop√≠rov√°no!';
                setTimeout(() => btn.textContent = 'üìã Kop√≠rovat', 2000);
            }
        }

        function downloadHTML() {
            const html = generateSignatureHTML();
            const firstName = document.getElementById('firstName').value;
            const lastName = document.getElementById('lastName').value;
            const blob = new Blob([html], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `podpis_${firstName}_${lastName}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function handleCSV(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                const text = e.target.result;
                const lines = text.split('\n');
                const employees = lines.slice(1)
                    .filter(line => line.trim())
                    .map(line => {
                        const values = line.split(',').map(v => v.trim());
                        return {
                            firstName: values[0],
                            lastName: values[1],
                            position: values[2],
                            phone: values[3],
                            email: values[4],
                            linkedin: values[5],
                            photoFilename: values[6]
                        };
                    });

                const resultDiv = document.getElementById('csvResult');
                resultDiv.innerHTML = `
                    <p class="text-sm text-green-600 font-medium mb-2">‚úì Naƒçteno ${employees.length} lid√≠</p>
                    <button onclick="downloadAllFromCSV()" class="w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors">
                        üíæ St√°hnout v≈°echny podpisy (${employees.length})
                    </button>
                `;

                window.csvEmployees = employees;
            };
            reader.readAsText(file);
        }

        function downloadAllFromCSV() {
            if (!window.csvEmployees) return;

            window.csvEmployees.forEach(person => {
                document.getElementById('firstName').value = person.firstName;
                document.getElementById('lastName').value = person.lastName;
                document.getElementById('position').value = person.position;
                document.getElementById('phone').value = person.phone;
                document.getElementById('email').value = person.email;
                document.getElementById('linkedin').value = person.linkedin;
                document.getElementById('photoFilename').value = person.photoFilename;
                
                // Nastav LinkedIn checkbox podle toho, jestli m√° osoba LinkedIn
                document.getElementById('showLinkedIn').checked = person.linkedin && person.linkedin.trim() !== '';

                const html = generateSignatureHTML();
                const blob = new Blob([html], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `podpis_${person.firstName}_${person.lastName}.html`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            });

            alert(`‚úÖ Hotovo! Sta≈æeno ${window.csvEmployees.length} podpis≈Ø`);
        }
    </script>
</body>
</html>